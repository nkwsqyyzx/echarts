<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>ECharts</title>
</head>

<body>
    <!--Step:2 Prepare a dom for ECharts which (must) has size (width & hight)-->
    <!--Step:2 为ECharts准备一个具备大小（宽高）的Dom-->
    <div id="main" style="height:600px;width:4500px;border:1px solid #ccc;padding:10px;"></div>
</body>
<!--Step:1 Import echarts-plain.js or echarts-plain-map.js-->
<!--Step:1 引入echarts-plain.js或者 echarts-plain-map.js-->
<script src="build/echarts-plain.js"></script>
<script type="text/javascript">
    Array.prototype.contains = function (obj) {
        var i = this.length;
        while (i--) {
            if (this[i] === obj) {
                return true;
            }
        }
        return false;
    }
</script>
<script type="text/javascript">
    // Step:3 echarts & zrender as a Global Interface by the echarts-plain.js.
    // Step:3 echarts和zrender被echarts-plain.js写入为全局接口
    // 10BET
    var chartData2 = [];

    chartData2.push({
        time: '01-11 04:37:33',
        s1: '1.10',
        p: '半球/一球',
        s2: '0.775'
    });
    chartData2.push({
        time: '01-11 16:57:31',
        s1: '1.05',
        p: '半球/一球',
        s2: '0.80'
    });
    chartData2.push({
        time: '01-12 02:31:35',
        s1: '1.00',
        p: '半球/一球',
        s2: '0.85'
    });
    chartData2.push({
        time: '01-12 16:48:05',
        s1: '1.025',
        p: '一球',
        s2: '0.825'
    });
    chartData2.push({
        time: '01-13 19:52:42',
        s1: '1.05',
        p: '半球/一球',
        s2: '0.80'
    });
    chartData2.push({
        time: '01-13 21:55:09',
        s1: '1.125',
        p: '半球/一球',
        s2: '0.75'
    });
    chartData2.push({
        time: '01-13 21:58:19',
        s1: '1.15',
        p: '半球/一球',
        s2: '0.725'
    });
    chartData2.push({
        time: '01-14 05:19:03',
        s1: '1.10',
        p: '半球/一球',
        s2: '0.775'
    });
    chartData2.push({
        time: '01-14 05:21:50',
        s1: '1.05',
        p: '半球/一球',
        s2: '0.80'
    });
    chartData2.push({
        time: '01-14 05:30:23',
        s1: '1.00',
        p: '半球/一球',
        s2: '0.85'
    });
    chartData2.push({
        time: '01-14 05:32:51',
        s1: '0.975',
        p: '半球/一球',
        s2: '0.875'
    });
    chartData2.push({
        time: '01-14 05:35:22',
        s1: '0.90',
        p: '半球/一球',
        s2: '0.95'
    });
    chartData2.push({
        time: '01-14 05:53:04',
        s1: '0.925',
        p: '半球/一球',
        s2: '0.925'
    });
    chartData2.push({
        time: '01-14 09:22:04',
        s1: '0.90',
        p: '半球/一球',
        s2: '0.95'
    });
    chartData2.push({
        time: '01-14 09:22:17',
        s1: '0.925',
        p: '半球/一球',
        s2: '0.925'
    });
    chartData2.push({
        time: '01-14 09:22:22',
        s1: '0.90',
        p: '半球/一球',
        s2: '0.95'
    });
    chartData2.push({
        time: '01-14 19:52:06',
        s1: '0.925',
        p: '半球/一球',
        s2: '0.925'
    });
    chartData2.push({
        time: '01-14 19:54:51',
        s1: '0.95',
        p: '半球/一球',
        s2: '0.90'
    });
    chartData2.push({
        time: '01-14 21:45:57',
        s1: '0.975',
        p: '半球/一球',
        s2: '0.875'
    });
    chartData2.push({
        time: '01-14 21:51:40',
        s1: '1.00',
        p: '半球/一球',
        s2: '0.85'
    });
    chartData2.push({
        time: '01-15 06:27:31',
        s1: '0.975',
        p: '半球/一球',
        s2: '0.875'
    });
    chartData2.push({
        time: '01-16 00:04:58',
        s1: '0.95',
        p: '半球/一球',
        s2: '0.90'
    });
    chartData2.push({
        time: '01-16 00:09:49',
        s1: '0.925',
        p: '半球/一球',
        s2: '0.925'
    });
    chartData2.push({
        time: '01-16 00:31:22',
        s1: '0.90',
        p: '半球/一球',
        s2: '0.95'
    });
    chartData2.push({
        time: '01-16 01:51:26',
        s1: '0.925',
        p: '半球/一球',
        s2: '0.925'
    });
    chartData2.push({
        time: '01-16 05:34:23',
        s1: '0.90',
        p: '半球/一球',
        s2: '0.95'
    });
    chartData2.push({
        time: '01-16 07:38:07',
        s1: '0.875',
        p: '半球/一球',
        s2: '0.975'
    });
    chartData2.push({
        time: '01-16 08:25:29',
        s1: '0.85',
        p: '半球/一球',
        s2: '1.00'
    });
    chartData2.push({
        time: '01-16 10:30:05',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 11:08:37',
        s1: '0.85',
        p: '半球/一球',
        s2: '1.00'
    });
    chartData2.push({
        time: '01-16 11:14:54',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 11:20:47',
        s1: '0.85',
        p: '半球/一球',
        s2: '1.00'
    });
    chartData2.push({
        time: '01-16 11:46:55',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 12:14:45',
        s1: '0.80',
        p: '半球/一球',
        s2: '1.05'
    });
    chartData2.push({
        time: '01-16 12:16:49',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 12:42:06',
        s1: '0.80',
        p: '半球/一球',
        s2: '1.05'
    });
    chartData2.push({
        time: '01-16 12:46:20',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 13:42:38',
        s1: '0.80',
        p: '半球/一球',
        s2: '1.05'
    });
    chartData2.push({
        time: '01-16 13:42:56',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 13:43:02',
        s1: '0.80',
        p: '半球/一球',
        s2: '1.05'
    });
    chartData2.push({
        time: '01-16 13:52:41',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 14:00:44',
        s1: '0.80',
        p: '半球/一球',
        s2: '1.05'
    });
    chartData2.push({
        time: '01-16 14:11:03',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 14:19:20',
        s1: '0.80',
        p: '半球/一球',
        s2: '1.05'
    });
    chartData2.push({
        time: '01-16 14:25:51',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 15:07:02',
        s1: '0.80',
        p: '半球/一球',
        s2: '1.05'
    });
    chartData2.push({
        time: '01-16 16:20:08',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 17:42:47',
        s1: '0.80',
        p: '半球/一球',
        s2: '1.05'
    });
    chartData2.push({
        time: '01-16 17:51:30',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 18:39:21',
        s1: '0.85',
        p: '半球/一球',
        s2: '1.00'
    });
    chartData2.push({
        time: '01-16 18:44:07',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 18:46:19',
        s1: '0.85',
        p: '半球/一球',
        s2: '1.00'
    });
    chartData2.push({
        time: '01-16 19:03:51',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 19:34:19',
        s1: '0.80',
        p: '半球/一球',
        s2: '1.05'
    });
    chartData2.push({
        time: '01-16 19:40:51',
        s1: '0.825',
        p: '半球/一球',
        s2: '1.025'
    });
    chartData2.push({
        time: '01-16 19:47:28',
        s1: '0.80',
        p: '半球/一球',
        s2: '1.05'
    });

    var thisYear = new Date().getFullYear();

    function DateFromString(sz) {
        return new Date("" + thisYear + "-" + sz.replace(' ', 'T'));
    }

    var dateShowed = [];

    var myChart = echarts.init(document.getElementById('main'));
    myChart.setOption({
        tooltip: {
            trigger: 'axis',
            formatter:function(params,ticket,callback)
            {
                var m = parseInt(ticket.substring(5));
                if (m < 0 || m > chartData2.length -1)return 'error when calculate '+ticket;
                var d = chartData2[m];
                return d.time+'<br/>'+d.s1+" "+ d.p+" "+d.s2;
            }
        },
        toolbox: {
            show: true,
            feature: {
                mark: true,
                dataView: {
                    readOnly: false
                },
                magicType: ['line', 'bar'],
                restore: true,
                saveAsImage: true
            }
        },
        dataZoom: {
            show: true
        },
        calculable: true,
        xAxis: [{
            type: 'category',
            isWsqData: true,
            getCoordByIndex: function (dataIndex) {
                var d0 = DateFromString(this.data[0]);
                var d1 = DateFromString(this.data[dataIndex]);
                var g = (d1 - d0) / 1000;
                return Math.floor(g / 360);
            },
            axisLabel: {
                show: true,
                formatter: function (value) {
                    var d = DateFromString(value);
                    if (dateShowed.contains(d.getDate()))
                        return value.substring(5);
                    else {
                        dateShowed.push(d.getDate());
                        return value;
                    }
                }
            },
            data: (function () {
                var d = [];
                for (var i = 0; i < chartData2.length; i++) {
                    d.push(chartData2[i].time);
                }
                return d;
            })(),
            axisTick: {
                show: true
            }
        }],
        yAxis: [{
            type: 'value',
            precision: 3,
            splitNumber: 50,
            min: 0.75,
            max: 1.25,
            scale: true,
            axisTick: {
                show: true
            },
            splitArea: {
                show: true
            }
        }],
        series: [{
            name: '蒸发量',
            type: 'line',
            data: (function () {
                var d = [];
                for (var i = 0; i < chartData2.length; i++) {
                    d.push(DataFromIndex(i));
                }
                return d;
            })()
        }]
    });

    function DataFromIndex(i) {
        if (i < 0 || i > chartData2.length - 1) return null;
        var d = chartData2[i];
        if (i == 0) return d.s1;
        var d0 = chartData2[i - 1];

        var r = {};
        r.value = d.s1;
        // 时间移动到下一天
        if (DateFromString(d0.time).getDate() != DateFromString(d.time).getDate()) {
            r.symbol = 'droplet';
            r.symbolSize = 5;
        }

        // 盘口改变
        if (d0.p != d.p) {
            r.symbol = 'star6';
            r.symbolSize = 40;
            r.symbolRotate = 10;
            r.itemStyle = {
                normal: {
                    color: 'yellowgreen'
                },
                emphasis: {
                    color: 'orange',
                    label: {
                        show: true,
                        position: 'inside',
                        textStyle: {
                            fontSize: '20'
                        }
                    }
                }
            };
        }

        return r;
    }
</script>

</html>
